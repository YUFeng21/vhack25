var e=require("agentkeepalive"),t=require("zod"),r=require("axios"),n=require("axios-retry");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=/*#__PURE__*/o(e),i=/*#__PURE__*/o(r),s=/*#__PURE__*/o(n);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(this,arguments)}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e){return void 0===e&&(e={maxFreeSockets:10,freeSocketTimeout:2e4}),new a.default(e)}function b(e){return void 0===e&&(e={maxFreeSockets:10,freeSocketTimeout:2e4}),new a.default.HttpsAgent(e)}var f=/*#__PURE__*/function(){function e(e){var t=e.baseURL,r=e.apikey,n=e.projectId,o=e.maxRetries,a=void 0===o?0:o,l=e.httpClient,u=e.timeout;this.maxRetries=void 0,this.httpClient=void 0,this.timeout=void 0,this.maxRetries=a,this.httpClient=l||i.default.create({}),this.timeout=u,this.httpClient.defaults.baseURL=t||"https://app.jamaibase.com",r&&n&&this.setApiKeyProjId(r,n),this.timeout&&(this.httpClient.defaults.timeout=this.timeout),a>0&&s.default(this.httpClient,{retries:this.maxRetries,retryDelay:function(e){return console.log("Retry attempt: ",e),1e3*e},retryCondition:function(e){return!0}}),this.httpClient.defaults.httpAgent=m(),this.httpClient.defaults.httpsAgent=b()}var t=e.prototype;return t.setHttpagentConfig=function(e){this.httpClient.defaults.httpAgent=m(e)},t.setHttpsagentConfig=function(e){this.httpClient.defaults.httpsAgent=b(e)},t.getHealth=function(){try{return Promise.resolve(this.httpClient.get("/health"))}catch(e){return Promise.reject(e)}},t.setApiKeyProjId=function(e,t){this.httpClient.defaults.headers.common.Authorization="Bearer "+e,this.httpClient.defaults.headers.common["x-project-id"]=t},t.setAuthHeader=function(e){this.httpClient.defaults.headers.common.Authorization=e},e}(),h=t.z.enum(["system","user","assistant","function"]),z=t.z.object({role:h,content:t.z.string(),name:t.z.string().optional().nullable()}),_=t.z.object({search_query:t.z.string().optional(),k:t.z.number().optional(),fetch_k:t.z.number().optional(),document_ids:t.z.array(t.z.string()).optional(),rank_profile:t.z.enum(["bm25","semantic","hybrid","hybrid_log"]).optional(),rerank:t.z.boolean().optional(),concat_reranker_input:t.z.boolean().optional()}),g=t.z.object({name:t.z.string(),description:t.z.string().optional(),parameters:t.z.record(t.z.string(),t.z.any())}),v=t.z.object({type:t.z.string().optional(),function:g});t.z.object({name:t.z.string()});var y=t.z.object({prompt_tokens:t.z.number().nullable().optional(),completions_tokens:t.z.number().nullable().optional(),total_tokens:t.z.number().nullable().optional()}),P=t.z.object({id:t.z.string().optional(),model:t.z.string().optional(),messages:t.z.array(z),rag_params:_.nullable().optional(),tools:t.z.array(v).nullable().optional(),tool_choice:t.z.union([t.z.string(),v]).nullable().optional(),temperature:t.z.number().optional().default(1).optional(),top_p:t.z.number().optional().default(1).optional(),n:t.z.number().optional().default(1).optional(),stop:t.z.array(t.z.string()).optional(),max_tokens:t.z.number().default(2048).optional(),presence_penalty:t.z.number().optional().default(0).optional(),frequency_penalty:t.z.number().optional().default(0).optional(),logit_bias:t.z.record(t.z.string(),t.z.any()).default({}).optional(),user:t.z.string().default("").optional()}),j=t.z.object({message:z,index:t.z.number(),finish_reason:t.z.string().nullable()}),w=t.z.object({message:z,index:t.z.number(),finish_reason:t.z.string().nullable(),delta:z.nullable()}),C=t.z.object({object:t.z.string()}),S=t.z.object({id:t.z.string(),object:t.z.enum(["chat.completion","chat.completion.chunk"]),created:t.z.number(),model:t.z.string(),usage:y.optional(),choices:t.z.union([t.z.array(j),t.z.array(w)]),references:C.nullable().optional()});function E(e){return t.z.object({items:t.z.array(e).describe("List of items paginated items.").default([]),offset:t.z.number().describe("Number of skipped items.").default(0),limit:t.z.number().describe("Number of items per page.").default(100),total:t.z.number().describe("Total number of items.").default(0)}).and(t.z.record(t.z.string(),t.z.any()))}t.z.object({id:t.z.string(),object:t.z.enum(["chat.completion.chunk"]),created:t.z.number(),model:t.z.string(),usage:y,choices:t.z.array(w),references:C.nullable().optional()});var R=t.z.object({offset:t.z.number().describe("Number of skipped items.").default(0),limit:t.z.number().describe("Number of items per page.").default(100)}),k=t.z.enum(["action","knowledge","chat"]),O=t.z.string().regex(/^[a-zA-Z0-9][a-zA-Z0-9_ \-]{0,98}[a-zA-Z0-9]$/,"Invalid Name"),x=t.z.enum(["int","int8","float","float64","float32","float16","bool","str","date-time","file","bytes"]),A=t.z.object({id:t.z.string(),dtype:x.default("str").optional(),vlen:t.z.number().int().gte(0).default(0).optional(),index:t.z.boolean().default(!0).optional(),gen_config:t.z.union([P.partial(),t.z.null()]).optional()});R.extend({parent_id:t.z.union([t.z.string(),t.z.null()]).optional()}).partial().extend({table_type:k});var N=t.z.object({id:t.z.string(),cols:t.z.array(A),parent_id:t.z.union([t.z.string(),t.z.null()]),title:t.z.string(),lock_till:t.z.union([t.z.number(),t.z.null()]).optional(),updated_at:t.z.string(),indexed_at_fts:t.z.union([t.z.string(),t.z.null()]),indexed_at_vec:t.z.union([t.z.string(),t.z.null()]),indexed_at_sca:t.z.union([t.z.string(),t.z.null()]),num_rows:t.z.number().int()});t.z.object({table_type:k,table_id:O}),R.extend({table_type:k,table_id:O,columns:t.z.array(O).nullable().optional()}).partial();var T=t.z.record(O,t.z.any());t.z.object({table_type:k,table_id:O,row_id:t.z.string(),columns:t.z.array(O).nullable().optional()});var D=t.z.record(O,t.z.any()),q=E(T),I=E(N),$=t.z.object({ok:t.z.boolean().default(!0)});t.z.object({table_type:k,table_id:O}),t.z.object({table_type:k,table_id_src:O,table_id_dst:O}),t.z.object({table_type:k,table_id_src:O,table_id_dst:O,include_data:t.z.boolean().optional(),deploy:t.z.boolean().optional()}),t.z.object({table_type:k,table_id:O,column_map:t.z.record(O,O)}),t.z.object({table_type:k,table_id:O,column_names:t.z.array(O)}),t.z.object({id:t.z.string().regex(/^[a-zA-Z0-9][a-zA-Z0-9_ \-]{0,98}[a-zA-Z0-9]$/),cols:t.z.array(A)}),t.z.object({table_type:k,table_id:O,column_map:t.z.record(O,t.z.record(t.z.any(),t.z.any()))}),t.z.object({table_type:k,table_id:O,row_id:t.z.string()}),t.z.object({table_type:k,reindex:t.z.boolean().default(!0).optional(),table_id:O,data:t.z.record(O,t.z.any())}),t.z.object({table_type:k,table_id:O,row_id:t.z.string()}),t.z.object({table_type:k,table_id:O,row_id:O,data:t.z.record(O,t.z.any())}),t.z.object({table_type:k,table_id:O,where:t.z.string().optional()}),t.z.object({table_type:k,table_id:O,query:t.z.string(),where:t.z.string().nullable().optional(),limit:t.z.number().gt(0).lte(1e3).optional(),metric:t.z.string().optional(),nprobes:t.z.number().gt(0).lte(1e3).optional(),refine_factor:t.z.number().gt(0).lte(1e3).optional(),reranking_model:t.z.string().nullable().optional()});var Z=t.z.array(t.z.any());t.z.object({id:t.z.string().regex(/^[a-zA-Z0-9][a-zA-Z0-9_ \-]{0,98}[a-zA-Z0-9]$/),cols:t.z.array(A)}),t.z.object({table_id:O});var J=t.z.object({object:t.z.enum(["chat.thread"]).describe("Type of API response object."),thread:t.z.array(z).describe("List of chat messages.").default([])}),H=t.z.object({object:t.z.enum(["gen_table.completion.chunks"]),columns:t.z.record(t.z.string(),S),row_id:t.z.string()});S.extend({output_column_name:t.z.string(),row_id:t.z.string()}),C.extend({object:t.z.enum(["gen_table.reference"]),output_column_name:t.z.string()});var U=["table_type"],F=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}u(t,e);var r=t.prototype;return r.listTables=function(e){var t=e.table_type,r=e.limit,n=void 0===r?100:r,o=e.offset,a=void 0===o?0:o,i=e.parent_id;try{var s="/api/v1/gen_tables/"+t+"?offset="+a+"&limit="+n;return i&&(s=s+"&parent_id="+i),Promise.resolve(this.httpClient.get(s)).then(function(e){return new Promise(function(t,r){200==e.status?t(I.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.getTable=function(e){try{return Promise.resolve(this.httpClient.get("/api/v1/gen_tables/"+e.table_type+"/"+e.table_id)).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.listRows=function(e){var t=e.columns,r=e.limit,n=void 0===r?100:r,o=e.offset,a=void 0===o?0:o,i=e.table_id,s=e.table_type;try{var l="/api/v1/gen_tables/"+s+"/"+i+"/rows?offset="+a+"&limit="+n;return t&&(l=l+"&"+t.map(function(e){return"columns="+encodeURIComponent(e)}).join("&")),Promise.resolve(this.httpClient.get(l)).then(function(e){return new Promise(function(t,r){200==e.status?t(q.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.getRow=function(e){try{var t="/api/v1/gen_tables/"+e.table_type+"/"+e.table_id+"/rows/"+e.row_id;return e.columns&&(t=t+"?"+e.columns.map(function(e){return"columns="+encodeURIComponent(e)}).join("&")),Promise.resolve(this.httpClient.get(t)).then(function(e){return new Promise(function(t,r){200==e.status?t(D.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.getConversationThread=function(e){try{return Promise.resolve(this.httpClient.get("/api/v1/gen_tables/chat/"+e.table_id+"/thread?table_id="+e.table_id)).then(function(e){return new Promise(function(t,r){200==e.status?t(J.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.createActionTable=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/action",l({},e,{stream:!1}),{})).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.createChatTable=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/chat",e)).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.createKnowledgeTable=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/knowledge",e)).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.deleteTable=function(e){try{return Promise.resolve(this.httpClient.delete("/api/v1/gen_tables/"+e.table_type+"/"+e.table_id)).then(function(e){return new Promise(function(t,r){200==e.status?t($.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.deleteRow=function(e){try{return Promise.resolve(this.httpClient.delete("/api/v1/gen_tables/"+e.table_type+"/"+e.table_id+"/rows/"+e.row_id)).then(function(e){return new Promise(function(t,r){200==e.status?t($.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.deleteRows=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/rows/delete",{table_id:e.table_id,where:e.where})).then(function(e){return new Promise(function(t,r){200==e.status?t($.parse({ok:!0})):(console.error("Received Error Status: ",e.status),t($.parse({ok:!1})))})})}catch(e){return Promise.reject(e)}},r.renameTable=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/rename/"+e.table_id_src+"/"+e.table_id_dst,{},{})).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.duplicateTable=function(e){var t=e.table_id_dst,r=e.table_id_src,n=e.table_type,o=e.include_data,a=void 0===o||o,i=e.deploy,s=void 0!==i&&i;try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+n+"/duplicate/"+r+"/"+t+"?include_data="+a+"&deploy="+s,{},{})).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.renameColumns=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/columns/rename",{table_id:e.table_id,column_map:e.column_map},{})).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.reorderColumns=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/columns/reorder",{table_id:e.table_id,column_names:e.column_names},{})).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.dropColumns=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/columns/drop",{table_id:e.table_id,column_names:e.column_names},{})).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.addActionColumns=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/action/columns/add",e)).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.addKnowledgeColumns=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/knowledge/columns/add",e)).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.addChatColumns=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/chat/columns/add",e)).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.updateGenConfig=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/gen_config/update",{table_id:e.table_id,column_map:e.column_map},{})).then(function(e){return new Promise(function(t,r){200==e.status?t(N.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.addRowStream=function(e){var t=e.table_id,r=e.table_type,n=e.data,o=e.reindex,a=void 0===o||o;try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+r+"/rows/add",{table_id:t,data:n,stream:!0},{responseType:"stream",params:{reindex:a}})).then(function(e){if(200!=e.status)throw new Error("Received Error Status: "+e.status);var t=new ReadableStream({start:function(t){try{return e.data.on("data",function(e){if((e=e.toString()).endsWith("\n\n"))for(var r,n=d(e.split("\n\n").filter(function(e){return e.trim()}).flatMap(function(e){return e.split("\n")}));!(r=n()).done;){var o=r.value.toString().replace(/^data: /,"").replace(/data: \[DONE\]\s+$/,"");if("[DONE]"==o.trim())return;try{var a=JSON.parse(o);t.enqueue(a)}catch(e){console.error("Error parsing:",o);continue}}else{var i=e.toString().replace(/^data: /,"").replace(/data: \[DONE\]\s+$/,"");if("[DONE]"==i.trim())return;try{var s=JSON.parse(i);t.enqueue(s)}catch(e){console.error("Error parsing:",i)}}}),e.data.on("error",function(e){console.error("error: ",e)}),e.data.on("end",function(){t.close()}),Promise.resolve()}catch(e){return Promise.reject(e)}}});return t})}catch(e){return Promise.reject(e)}},r.addRow=function(e){var t=e.table_id,r=e.table_type,n=e.data,o=e.reindex,a=void 0===o||o;try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+r+"/rows/add",{table_id:t,stream:!1,data:n},{params:{reindex:a}})).then(function(e){return new Promise(function(t,r){200==e.status?t(H.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.regenRowStream=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/rows/regen",{table_id:e.table_id,row_id:e.row_id,stream:!0},{responseType:"stream"})).then(function(e){if(200!=e.status)throw new Error("Received Error Status: "+e.status);return new ReadableStream({start:function(t){try{return e.data.on("data",function(e){if((e=e.toString()).endsWith("\n\n"))for(var r,n=d(e.split("\n\n").filter(function(e){return e.trim()}).flatMap(function(e){return e.split("\n")}));!(r=n()).done;){var o=r.value.toString().replace(/^data: /,"").replace(/data: \[DONE\]\s+$/,"");if("[DONE]"==o.trim())return;try{var a=JSON.parse(o);t.enqueue(a)}catch(e){console.error("Error parsing:",o);continue}}else{var i=e.toString().replace(/^data: /,"").replace(/data: \[DONE\]\s+$/,"");if("[DONE]"==i.trim())return;try{var s=JSON.parse(i);t.enqueue(s)}catch(e){console.error("Error parsing:",i)}}}),e.data.on("error",function(e){console.error("error: ",e)}),e.data.on("end",function(){t.close()}),Promise.resolve()}catch(e){return Promise.reject(e)}}})})}catch(e){return Promise.reject(e)}},r.regenRow=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/rows/regen",{table_id:e.table_id,row_id:e.row_id,stream:!1},{})).then(function(e){return new Promise(function(t,r){200==e.status?t(H.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.updateRow=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/gen_tables/"+e.table_type+"/rows/update",{table_id:e.table_id,row_id:e.row_id,data:e.data})).then(function(e){return new Promise(function(t,r){200==e.status?t($.parse({ok:!0})):(console.error("Received Error Status: ",e.status),t($.parse({ok:!1})))})})}catch(e){return Promise.reject(e)}},r.hybridSearch=function(e){try{var t="/api/v1/gen_tables/"+e.table_type+"/hybrid_search",r=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||(o[r]=e[r]);return o}(e,U);return Promise.resolve(this.httpClient.post(t,r)).then(function(e){return new Promise(function(t,r){200==e.status?t(Z.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.uploadFile=function(e){try{var t=this,r=new FormData;return r.append("file",e.file),r.append("file_name",e.file_name),r.append("table_id",e.table_id),null!=e&&e.chunk_size&&r.append("chunk_size",e.chunk_size.toString()),null!=e&&e.chunk_overlap&&r.append("chunk_overlap",e.chunk_overlap.toString()),Promise.resolve(function(e,n){try{var o=Promise.resolve(t.httpClient.post("/api/v1/gen_tables/knowledge/upload_file",r,{headers:{"Content-Type":"multipart/form-data"}})).then(function(e){return e.data})}catch(e){return n(e)}return o&&o.then?o.then(void 0,n):o}(0,function(e){throw console.error("Error uploading file:",e),e}))}catch(e){return Promise.reject(e)}},t}(f);t.z.object({model:t.z.string().optional(),capabilities:t.z.enum(["completion","chat","image","embed","rerank"]).nullable().optional()});var K=t.z.object({id:t.z.string().default("openai/gpt-3.5-turbo"),object:t.z.string(),name:t.z.string(),context_length:t.z.number().default(16384),languages:t.z.array(t.z.string()),capabilities:t.z.array(t.z.enum(["completion","chat","image","embed","rerank"])).default(["chat"]),created:t.z.number(),owned_by:t.z.string()}),L=t.z.object({object:t.z.enum(["chat.model_info"]),data:t.z.array(K)});t.z.object({prefer:t.z.string().optional(),capabilities:t.z.enum(["completion","chat","image","embed","rerank"]).nullable().optional()});var M,W=t.z.array(t.z.string()),B=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}u(t,e);var r=t.prototype;return r.modelInfo=function(e){try{return Promise.resolve(this.httpClient.get("/api/v1/models",{params:e})).then(function(e){return new Promise(function(t,r){200==e.status?t(L.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.modelNames=function(e){try{return Promise.resolve(this.httpClient.get("/api/v1/model_names",{params:e})).then(function(e){return new Promise(function(t,r){200==e.status?t(W.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},r.generateChatCompletionsStream=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/chat/completions",l({},e,{stream:!0}),{responseType:"stream"})).then(function(e){return new ReadableStream({start:function(t){try{return e.data.on("data",function(e){if((e=e.toString()).endsWith("\n\n"))for(var r,n=d(e.split("\n\n").filter(function(e){return e.trim()}).flatMap(function(e){return e.split("\n")}));!(r=n()).done;){var o=r.value.toString().replace(/^data: /,"").replace(/data: \[DONE\]\s+$/,"");if("[DONE]"==o.trim())return;try{var a=JSON.parse(o);t.enqueue(a)}catch(e){console.error("Error parsing:",o);continue}}else{var i=e.toString().replace(/^data: /,"").replace(/data: \[DONE\]\s+$/,"");if("[DONE]"==i.trim())return;try{var s=JSON.parse(i);t.enqueue(s)}catch(e){console.error("Error parsing:",i)}}}),e.data.on("error",function(e){console.error("error: ",e)}),e.data.on("end",function(){t.close()}),Promise.resolve()}catch(e){return Promise.reject(e)}}})})}catch(e){return Promise.reject(e)}},r.generateChatCompletions=function(e){try{return Promise.resolve(this.httpClient.post("/api/v1/chat/completions",l({},e,{stream:!1}),{})).then(function(e){return new Promise(function(t,r){200==e.status?t(S.parse(e.data)):console.error("Received Error Status: ",e.status)})})}catch(e){return Promise.reject(e)}},t}(f),G=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t}(f);M=G,[F,B].forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(t){Object.defineProperty(M.prototype,t,Object.getOwnPropertyDescriptor(e.prototype,t)||Object.create(null))})}),module.exports=G;
